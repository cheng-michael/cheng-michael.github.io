<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>michael cheng</title>
    <style>
        :root {
            /* LIGHT MODE */
            --bg: #ffffff;
            --headings: #000000;
            --text: #555555;
            --btn-active: #000000;
        }

        body.dark-mode {
            /* DARK MODE */
            --bg: #111111;
            --headings: #ffffff;
            --text: #a0a0a0;
            --btn-active: #ffffff;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: Menlo, Monaco, Consolas, "Courier New", monospace;
            font-size: 14px;
            line-height: 1.6;
            text-transform: lowercase;
            
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 2rem;
            
            transition: background-color 0.3s, color 0.3s;
            overflow-x: hidden; /* Prevent scrollbars from the effect */
        }

        /* The Content Block */
        main {
            max-width: 520px;
            width: 100%;
            text-align: left;
            position: relative;
            z-index: 10; /* Keeps text above the effect if we want, but we will mask it anyway */
        }

        h1 {
            color: var(--headings);
            font-size: 14px;
            font-weight: normal;
            margin-bottom: 2rem;
        }

        p {
            margin-bottom: 2rem;
        }

        ul {
            list-style: none;
            margin-bottom: 2rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        a {
            color: inherit;
            text-decoration: underline;
            cursor: pointer;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--headings);
            text-decoration-style: double;
        }

        /* BUTTONS (Theme Toggle & Ripple Trigger) */
        .corner-btn {
            position: fixed;
            bottom: 2rem;
            background: none;
            border: none;
            color: var(--text);
            font-family: inherit;
            font-size: 14px;
            cursor: pointer;
            text-decoration: underline;
            padding: 0.5rem;
            opacity: 0.7;
            z-index: 20; /* Above everything */
        }

        .corner-btn:hover {
            color: var(--headings);
            opacity: 1;
        }

        /* Right Corner */
        #theme-toggle { right: 2rem; }

        /* Left Corner (New) */
        #ripple-trigger { left: 2rem; }

        /* THE ASCII CANVAS LAYER */
        canvas#ascii-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none; /* Lets clicks pass through to links */
            z-index: 1; /* Sits above background but below buttons */
        }
    </style>
</head>
<body>

    <canvas id="ascii-overlay"></canvas>

    <main id="content-block">
        <h1>michael cheng</h1>

        <p>
            lorem ipsum dolor sit amet, consectetur adipiscing elit. sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
        </p>

        <ul>
            <li>
                <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#109;&#101;&#64;&#109;&#105;&#99;&#104;&#97;&#101;&#108;&#99;&#104;&#101;&#110;&#103;&#46;&#100;&#101;&#118;">email</a>
            </li>
            <li>
                <a href="https://github.com/michaelchengdev">github</a>
            </li>
            <li>
                <a href="https://www.linkedin.com/in/michaelchengdev/">linkedin</a>
            </li>
        </ul>

        <p>
            viverra ipsum nunc aliquet bibendum enim facilisis gravida neque convallis.
        </p>
    </main>

    <button id="ripple-trigger" class="corner-btn">effect</button>
    <button id="theme-toggle" class="corner-btn">dark</button>

    <script>
        // --- 1. THEME TOGGLE LOGIC ---
        const toggleButton = document.getElementById('theme-toggle');
        const body = document.body;

        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            body.classList.add('dark-mode');
            toggleButton.textContent = 'light';
        }

        toggleButton.addEventListener('click', () => {
            body.classList.toggle('dark-mode');
            toggleButton.textContent = body.classList.contains('dark-mode') ? 'light' : 'dark';
        });


        // --- 2. ASCII RIPPLE PHYSICS ENGINE ---
        const canvas = document.getElementById('ascii-overlay');
        const ctx = canvas.getContext('2d');
        const triggerBtn = document.getElementById('ripple-trigger');
        const contentBlock = document.getElementById('content-block');
        
        // Configuration
        const CHARS = ['.', '+', '*', '~', 'Â°', 'x', 'o'];
        const FONT_SIZE = 14; // Matches your body text
        const SPEED = 4; // Expansion speed
        const WAVE_WIDTH = 100; // Thickness of the ripple band
        const RIPPLE_DURATION = 2000; // How long a ripple lasts (ms)

        let ripples = []; // Store active ripples
        let w, h;

        // Resize canvas to fill screen
        function resize() {
            w = canvas.width = window.innerWidth;
            h = canvas.height = window.innerHeight;
            ctx.font = `${FONT_SIZE}px Menlo, Monaco, Consolas, monospace`;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
        }
        window.addEventListener('resize', resize);
        resize();

        // The Ripple Class
        class Ripple {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.startTime = Date.now();
                this.maxRadius = Math.max(w, h) * 1.5; // Enough to cover screen
            }

            isActive() {
                return (Date.now() - this.startTime) < RIPPLE_DURATION;
            }

            getRadius() {
                const age = Date.now() - this.startTime;
                return age * (SPEED / 10) * 2; // Simple linear expansion
            }
        }

        // Trigger on Click
        triggerBtn.addEventListener('click', (e) => {
            // Spawn ripple from the button's position
            const rect = triggerBtn.getBoundingClientRect();
            const startX = rect.left + rect.width / 2;
            const startY = rect.top + rect.height / 2;
            ripples.push(new Ripple(startX, startY));
        });

        // Also trigger on hold (mousedown/mouseup loop) if desired, 
        // but for now simple click spamming works best for "water" feel.

        // The Animation Loop
        function animate() {
            ctx.clearRect(0, 0, w, h);

            // Get "Forbidden Zone" (The content block)
            const contentRect = contentBlock.getBoundingClientRect();
            // Add a little padding to the forbidden zone
            const pad = 20; 
            const forbidden = {
                left: contentRect.left - pad,
                right: contentRect.right + pad,
                top: contentRect.top - pad,
                bottom: contentRect.bottom + pad
            };

            // Only calculate grid if there are active ripples
            if (ripples.length > 0) {
                // Remove old ripples
                ripples = ripples.filter(r => r.isActive());

                // Iterate over a grid of the screen
                // We skip steps equal to FONT_SIZE to create a "text grid"
                for (let y = 0; y < h; y += FONT_SIZE) {
                    for (let x = 0; x < w; x += FONT_SIZE * 0.6) { // 0.6 aspect ratio correction for monospace width
                        
                        // 1. COLLISION CHECK: If inside content, skip immediately
                        if (x > forbidden.left && x < forbidden.right && 
                            y > forbidden.top && y < forbidden.bottom) {
                            continue;
                        }

                        // 2. CHECK RIPPLES
                        let totalIntensity = 0;

                        for (let r of ripples) {
                            const dx = x - r.x;
                            const dy = y - r.y;
                            const dist = Math.sqrt(dx * dx + dy * dy);
                            const currentRadius = r.getRadius();

                            // The "Wave" Logic:
                            // We want characters to appear only in a specific band (currentRadius +/- width)
                            // We use a sine wave to make them fade in/out smoothly within that band
                            const distFromWave = Math.abs(dist - currentRadius);
                            
                            if (distFromWave < WAVE_WIDTH) {
                                // Map distance to an intensity (0 to 1)
                                // Closer to the exact radius = more intense
                                const intensity = Math.cos((distFromWave / WAVE_WIDTH) * (Math.PI / 2));
                                totalIntensity += intensity;
                            }
                        }

                        // 3. DRAW
                        if (totalIntensity > 0.1) {
                            // Cap intensity at 1
                            const alpha = Math.min(totalIntensity, 1);
                            
                            // Pick a character based on location (pseudo-random but stable)
                            // This makes the "water" feel structured rather than chaotic static
                            const charIndex = Math.floor((x + y + Date.now()/100) % CHARS.length);
                            
                            // Color Logic based on theme
                            const isDark = body.classList.contains('dark-mode');
                            const color = isDark ? `rgba(255, 255, 255, ${alpha})` : `rgba(0, 0, 0, ${alpha})`;

                            ctx.fillStyle = color;
                            ctx.fillText(CHARS[charIndex], x, y);
                        }
                    }
                }
            }

            requestAnimationFrame(animate);
        }

        animate();

    </script>
</body>
</html>
